<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Insight Crawler</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 2.5rem;
            font-weight: 300;
        }

        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }

        .form-group {
            margin-bottom: 30px;
        }

        .input-group {
            position: relative;
            margin-bottom: 20px;
        }

        .url-input {
            width: 100%;
            padding: 20px 20px 20px 50px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background: #f7fafc;
        }

        .url-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .url-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #a0aec0;
            font-size: 1.2rem;
        }

        .analyze-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            margin: 20px 0;
        }

        .status-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #e2e8f0;
        }

        .status-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .status-icon {
            font-size: 1.5rem;
            margin-right: 12px;
            animation: pulse 2s infinite;
        }

        .status-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
        }

        .progress-steps {
            margin-bottom: 25px;
        }

        .step-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .step-item.active {
            background: rgba(102, 126, 234, 0.1);
            border-left: 3px solid #667eea;
            padding-left: 15px;
        }

        .step-item.completed {
            background: rgba(56, 161, 105, 0.1);
            border-left: 3px solid #38a169;
            padding-left: 15px;
        }

        .step-icon {
            font-size: 1.2rem;
            margin-right: 15px;
            width: 30px;
            text-align: center;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            color: #2d3748;
            font-size: 0.95rem;
            margin-bottom: 2px;
        }

        .step-description {
            color: #718096;
            font-size: 0.85rem;
        }

        .step-status {
            font-size: 1rem;
            margin-left: 10px;
        }

        .step-item.active .step-status {
            animation: spin 1s linear infinite;
        }

        .step-item.completed .step-status {
            color: #38a169;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s ease;
        }

        .current-status {
            text-align: center;
            color: #4a5568;
            font-size: 0.9rem;
            font-style: italic;
            margin-top: 15px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-container {
            margin-top: 30px;
            display: none;
        }

        .result-content {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border-left: 4px solid #667eea;
            max-height: 500px;
            overflow-y: auto;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.95rem;
            line-height: 1.6;
            color: #2d3748;
        }

        /* Markdown Styling */
        .result-content h1,
        .result-content h2,
        .result-content h3,
        .result-content h4 {
            color: #2d3748;
            margin: 1.5rem 0 1rem 0;
            font-weight: 600;
        }

        .result-content h1 {
            font-size: 1.8rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }

        .result-content h2 {
            font-size: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 0.3rem;
        }

        .result-content h3 {
            font-size: 1.3rem;
        }

        .result-content h4 {
            font-size: 1.1rem;
        }

        .result-content p {
            margin: 0.8rem 0;
            color: #4a5568;
        }

        .result-content ul,
        .result-content ol {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        .result-content li {
            margin: 0.5rem 0;
            color: #4a5568;
        }

        .result-content strong {
            color: #2d3748;
            font-weight: 600;
        }

        .result-content em {
            color: #718096;
            font-style: italic;
        }

        .result-content code {
            background: #edf2f7;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #e53e3e;
        }

        .result-content pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .result-content pre code {
            background: none;
            padding: 0;
            color: inherit;
        }

        .result-content blockquote {
            border-left: 4px solid #667eea;
            padding-left: 1rem;
            margin: 1rem 0;
            color: #718096;
            font-style: italic;
        }

        .result-content hr {
            border: none;
            border-top: 1px solid #e2e8f0;
            margin: 2rem 0;
        }

        .result-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .result-content th,
        .result-content td {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            text-align: left;
        }

        .result-content th {
            background: #f7fafc;
            font-weight: 600;
            color: #2d3748;
        }

        /* Additional Markdown Enhancements */
        .result-content ul li::marker {
            color: #667eea;
        }

        .result-content ol li::marker {
            color: #667eea;
            font-weight: 600;
        }

        .result-content ul ul,
        .result-content ol ol {
            margin: 0.5rem 0;
        }

        .result-content ul ul li::marker {
            color: #718096;
        }

        .result-content ol ol li::marker {
            color: #718096;
        }

        /* Highlight important information */
        .result-content strong {
            background: linear-gradient(120deg, rgba(102, 126, 234, 0.1) 0%, rgba(102, 126, 234, 0.1) 100%);
            background-repeat: no-repeat;
            background-size: 100% 0.2em;
            background-position: 0 88%;
            transition: background-size 0.25s ease-in;
        }

        .result-content strong:hover {
            background-size: 100% 100%;
        }

        /* Company name highlighting */
        .result-content h2:first-of-type {
            color: #667eea;
            font-size: 1.6rem;
            margin-top: 0;
        }

        /* Section dividers */
        .result-content h3 {
            border-left: 3px solid #667eea;
            padding-left: 1rem;
            margin-left: -1rem;
        }

        .error {
            background: #fed7d7;
            border-left-color: #e53e3e;
            color: #c53030;
        }

        .success {
            background: #c6f6d5;
            border-left-color: #38a169;
            color: #2f855a;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            overflow: hidden;
            margin: 20px 0;
            display: none;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        .status-text {
            text-align: center;
            color: #718096;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        /* Header Container */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 30px;
        }

        .header-content {
            flex: 1;
        }

        .about-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            border-radius: 25px;
            transition: all 0.3s ease;
            margin-left: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .about-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        /* Main Content */
        .main-content {
            display: block;
        }

        /* Tool Description */
        .tool-description {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            border-left: 4px solid #667eea;
        }

        .tool-description p {
            color: #4a5568;
            font-size: 1rem;
            line-height: 1.6;
            margin: 0;
            text-align: center;
        }

        /* About Section */
        .about-section {
            display: none;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e2e8f0;
        }

        .about-section.active {
            display: block;
        }

        .about-section h2 {
            color: #2d3748;
            margin-bottom: 25px;
            font-size: 2rem;
            text-align: center;
        }

        .about-section h3 {
            color: #4a5568;
            margin: 35px 0 20px 0;
            font-size: 1.4rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }

        /* About Content */
        .about-content {
            max-width: 100%;
        }

        .about-description {
            color: #718096;
            line-height: 1.6;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        /* Workflow Steps */
        .workflow {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 25px 0;
        }

        .step {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
            text-align: center;
        }

        .step-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            line-height: 40px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .step h4 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .step p {
            color: #718096;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        /* Technology Grid */
        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }

        .tech-category {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .tech-category h4 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }

        .tech-category ul {
            list-style: none;
            padding: 0;
        }

        .tech-category li {
            color: #718096;
            margin-bottom: 8px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .tech-category strong {
            color: #4a5568;
        }

        /* Use Cases */
        .use-cases {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 25px 0;
        }

        .use-case {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .use-case .icon {
            font-size: 2rem;
            margin-bottom: 15px;
            display: block;
        }

        .use-case h4 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .use-case p {
            color: #718096;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        /* About Footer */
        .about-footer {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-top: 30px;
            border-left: 4px solid #38a169;
        }

        .about-footer p {
            color: #4a5568;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .about-footer strong {
            color: #2d3748;
        }

        /* Download Section */
        .download-section {
            margin-top: 20px;
            text-align: center;
        }

        .download-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .download-btn {
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .pdf-btn {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            box-shadow: 0 4px 12px rgba(229, 62, 62, 0.3);
        }

        .pdf-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(229, 62, 62, 0.4);
        }

        .md-btn {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            box-shadow: 0 4px 12px rgba(56, 161, 105, 0.3);
        }

        .md-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(56, 161, 105, 0.4);
        }

        .txt-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .txt-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .download-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Footer */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-top: 1px solid #e2e8f0;
            padding: 15px 0;
            text-align: center;
            z-index: 100;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .footer p {
            color: #718096;
            font-size: 0.9rem;
            margin: 0;
        }

        .footer a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .footer a:hover {
            color: #764ba2;
        }

        /* Adjust container to account for footer */
        body {
            padding-bottom: 80px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 30px 20px;
                margin: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .url-input {
                padding: 15px 15px 15px 45px;
                font-size: 1rem;
            }

            .header-container {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .about-btn {
                margin: 15px 0 0 0;
                padding: 10px 20px;
                font-size: 0.8rem;
            }

            .about-section h2 {
                font-size: 1.6rem;
            }

            .about-section h3 {
                font-size: 1.2rem;
            }

            .workflow, .use-cases {
                grid-template-columns: 1fr;
            }
            
            .tech-grid {
                grid-template-columns: 1fr;
            }

            /* Mobile adjustments */
            .tool-description {
                padding: 15px;
                margin-bottom: 20px;
            }

            .tool-description p {
                font-size: 0.9rem;
            }

            /* Mobile adjustments */
            .download-buttons {
                flex-direction: column;
                gap: 10px;
            }

            .download-btn {
                padding: 12px 24px;
                font-size: 0.8rem;
                min-width: 100px;
            }

            /* Mobile Markdown adjustments */
            .result-content {
                font-size: 0.9rem;
                padding: 20px;
            }

            .result-content h1 {
                font-size: 1.5rem;
            }

            .result-content h2 {
                font-size: 1.3rem;
            }

            .result-content h3 {
                font-size: 1.1rem;
            }

            .result-content pre {
                font-size: 0.8rem;
                padding: 0.8rem;
            }

            .result-content table {
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-container">
            <div class="header-content">
                <h1>🔍 Market Insight Crawler</h1>
                <p class="subtitle">Intelligent website analysis with AI</p>
            </div>
            <button class="about-btn" data-tab="about">About</button>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <div class="tool-description">
                <p>This AI-powered tool analyzes any website and generates comprehensive business intelligence reports. Simply enter a URL and get detailed insights about the company's mission, products, market positioning, and commercial opportunities.</p>
            </div>
            
            <form id="analyzeForm">
                <div class="form-group">
                    <div class="input-group">
                        <span class="url-icon">🌐</span>
                        <input 
                            type="url" 
                            id="urlInput" 
                            class="url-input" 
                            placeholder="Enter the website URL (ex: example.com)"
                            required
                        >
                    </div>
                </div>
                
                <button type="submit" id="analyzeBtn" class="analyze-btn">
                    🚀 Analyze Website
                </button>
            </form>

            <div class="loading" id="loading">
                <div class="status-container">
                    <div class="status-header">
                        <div class="status-icon">⏳</div>
                        <div class="status-title">Analysis in Progress</div>
                    </div>
                    
                    <div class="progress-steps">
                        <div class="step-item" data-step="scraping">
                            <div class="step-icon">🌐</div>
                            <div class="step-content">
                                <div class="step-title">Web Scraping</div>
                                <div class="step-description">Extracting content and links...</div>
                            </div>
                            <div class="step-status">⏳</div>
                        </div>
                        
                        <div class="step-item" data-step="classification">
                            <div class="step-icon">🧠</div>
                            <div class="step-content">
                                <div class="step-title">Link Classification</div>
                                <div class="step-description">Analyzing relevant pages...</div>
                            </div>
                            <div class="step-status">⏸️</div>
                        </div>
                        
                        <div class="step-item" data-step="aggregation">
                            <div class="step-icon">📄</div>
                            <div class="step-content">
                                <div class="step-title">Content Aggregation</div>
                                <div class="step-description">Collecting page content...</div>
                            </div>
                            <div class="step-status">⏸️</div>
                        </div>
                        
                        <div class="step-item" data-step="summary">
                            <div class="step-icon">📊</div>
                            <div class="step-content">
                                <div class="step-title">Business Summary</div>
                                <div class="step-description">Generating analysis...</div>
                            </div>
                            <div class="step-status">⏸️</div>
                        </div>
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    
                    <div class="current-status" id="currentStatus">
                        Starting analysis...
                    </div>
                </div>
            </div>

            <div class="result-container" id="resultContainer">
                <div class="result-content" id="resultContent"></div>
                <div class="download-section" id="downloadSection" style="display: none;">
                    <div class="download-buttons">
                        <button class="download-btn pdf-btn" id="downloadPdfBtn">
                            📄 PDF Report
                        </button>
                        <button class="download-btn md-btn" id="downloadMdBtn">
                            📝 Markdown
                        </button>
                        <button class="download-btn txt-btn" id="downloadTxtBtn">
                            📄 Text File
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Section -->
        <div class="about-section" id="about-section">
            <div class="about-content">
                <h2>🤖 About This Project</h2>
                
                <p class="about-description">
                    Market Insight Crawler is a Python-based tool that simulates AI agent behavior using simple LLM calls, 
                    without complex frameworks like LangChain or AutoGen. It demonstrates how thoughtful prompt design and 
                    modular thinking can create intelligent applications.
                </p>

                <h3>🎯 How It Works</h3>
                <div class="workflow">
                    <div class="step">
                        <span class="step-number">1</span>
                        <h4>Web Scraping</h4>
                        <p>Extracts content and links from the target website</p>
                    </div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <h4>Link Classification</h4>
                        <p>LLM analyzes and filters relevant internal links</p>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <h4>Content Aggregation</h4>
                        <p>Collects and processes content from relevant pages</p>
                    </div>
                    <div class="step">
                        <span class="step-number">4</span>
                        <h4>Business Summary</h4>
                        <p>Generates structured analysis in Markdown format</p>
                    </div>
                </div>

                <h3>🛠️ Technologies Used</h3>
                <div class="tech-grid">
                    <div class="tech-category">
                        <h4>Backend</h4>
                        <ul>
                            <li><strong>Python 3.10+</strong> - Core language</li>
                            <li><strong>Flask</strong> - Web framework</li>
                            <li><strong>BeautifulSoup4</strong> - Web scraping</li>
                            <li><strong>Requests</strong> - HTTP client</li>
                        </ul>
                    </div>
                    <div class="tech-category">
                        <h4>AI & LLMs</h4>
                        <ul>
                            <li><strong>OpenAI API</strong> - GPT-4 integration</li>
                            <li><strong>Google Gemini</strong> - Alternative LLM</li>
                            <li><strong>Streaming</strong> - Real-time responses</li>
                        </ul>
                    </div>
                    <div class="tech-category">
                        <h4>Frontend</h4>
                        <ul>
                            <li><strong>HTML5/CSS3</strong> - Modern interface</li>
                            <li><strong>JavaScript</strong> - Interactive features</li>
                            <li><strong>Glass-morphism</strong> - Visual design</li>
                        </ul>
                    </div>
                    <div class="tech-category">
                        <h4>Features</h4>
                        <ul>
                            <li><strong>Real-time streaming</strong> - Live analysis</li>
                            <li><strong>Responsive design</strong> - Mobile-friendly</li>
                            <li><strong>Error handling</strong> - Robust UX</li>
                        </ul>
                    </div>
                </div>

                <h3>💡 Use Cases</h3>
                <div class="use-cases">
                    <div class="use-case">
                        <span class="icon">💼</span>
                        <h4>Sales Intelligence</h4>
                        <p>Research potential clients and understand their business</p>
                    </div>
                    <div class="use-case">
                        <span class="icon">📊</span>
                        <h4>Market Analysis</h4>
                        <p>Study competitors and market positioning</p>
                    </div>
                    <div class="use-case">
                        <span class="icon">🚀</span>
                        <h4>Business Development</h4>
                        <p>Identify partnership and integration opportunities</p>
                    </div>
                    <div class="use-case">
                        <span class="icon">📈</span>
                        <h4>CRM Enrichment</h4>
                        <p>Automatically gather company information</p>
                    </div>
                </div>

                <div class="about-footer">
                    <p><strong>Open Source:</strong> This project is available on <a href="https://github.com/alexguimenti/market-insight-crawler" target="_blank" rel="noopener noreferrer">GitHub</a> for learning and adaptation.</p>
                    <p><strong>Educational:</strong> Demonstrates AI agent simulation without complex frameworks.</p>
                </div>
            </div>
        </div>


    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>Created by <a href="https://www.linkedin.com/in/alexandre-guimenti/" target="_blank" rel="noopener noreferrer">Alexandre Guimenti</a> | <a href="https://github.com/alexguimenti/market-insight-crawler" target="_blank" rel="noopener noreferrer">GitHub</a></p>
        </div>
    </footer>

    <script>
        const form = document.getElementById('analyzeForm');
        const urlInput = document.getElementById('urlInput');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const loading = document.getElementById('loading');
        const resultContainer = document.getElementById('resultContainer');
        const resultContent = document.getElementById('resultContent');
        const downloadSection = document.getElementById('downloadSection');
        const downloadPdfBtn = document.getElementById('downloadPdfBtn');
        const downloadMdBtn = document.getElementById('downloadMdBtn');
        const downloadTxtBtn = document.getElementById('downloadTxtBtn');
        const progressBar = document.getElementById('progressBar');
        const progressFill = document.getElementById('progressFill');
        const statusText = document.getElementById('statusText');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const url = urlInput.value.trim();
            if (!url) return;

            // Reset UI
            analyzeBtn.disabled = true;
            analyzeBtn.textContent = '⏳ Analyzing...';
            loading.style.display = 'block';
            resultContainer.style.display = 'none';
            
            // Initialize progress
            updateProgress('scraping', 'active');
            updateCurrentStatus('Initializing web scraping...');
            
            // Start progress simulation
            const progressInterval = simulateProgress();

            try {
                const response = await fetch('/analyze_stream', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ url: url })
                });

                if (!response.ok) {
                    throw new Error('Erro na requisição');
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let result = '';

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value);
                    const lines = chunk.split('\n');

                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            try {
                                const data = JSON.parse(line.slice(6));
                                
                                if (data.error) {
                                    showError(data.error);
                                    return;
                                }
                                
                                if (data.result) {
                                    result = data.result;
                                    // Mark all steps as completed
                                    updateProgress('scraping', 'completed');
                                    updateProgress('classification', 'completed');
                                    updateProgress('aggregation', 'completed');
                                    updateProgress('summary', 'completed');
                                    updateProgressFill(100);
                                    updateCurrentStatus('Analysis completed!');
                                    
                                    setTimeout(() => {
                                        showResult(result);
                                    }, 500);
                                    return;
                                }
                            } catch (e) {
                                console.error('Erro ao processar dados:', e);
                            }
                        }
                    }
                }

            } catch (error) {
                showError('Error connecting to server: ' + error.message);
            } finally {
                if (progressInterval) {
                    clearInterval(progressInterval);
                }
                resetUI();
            }
        });

        // Progress control functions
        function updateProgress(step, status) {
            const stepElement = document.querySelector(`[data-step="${step}"]`);
            if (stepElement) {
                stepElement.className = `step-item ${status}`;
                const statusElement = stepElement.querySelector('.step-status');
                
                if (status === 'active') {
                    statusElement.textContent = '⏳';
                } else if (status === 'completed') {
                    statusElement.textContent = '✅';
                } else {
                    statusElement.textContent = '⏸️';
                }
            }
        }

        function updateProgressFill(percentage) {
            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = `${percentage}%`;
        }

        function updateCurrentStatus(message) {
            const currentStatus = document.getElementById('currentStatus');
            currentStatus.textContent = message;
        }

        // Simulate progress for better UX
        function simulateProgress() {
            let currentStep = 0;
            const steps = ['scraping', 'classification', 'aggregation', 'summary'];
            const messages = [
                'Extracting content and links from website...',
                'Analyzing and classifying relevant pages...',
                'Collecting and processing page content...',
                'Generating business intelligence summary...'
            ];

            const interval = setInterval(() => {
                if (currentStep < steps.length) {
                    // Complete previous step
                    if (currentStep > 0) {
                        updateProgress(steps[currentStep - 1], 'completed');
                    }
                    
                    // Activate current step
                    updateProgress(steps[currentStep], 'active');
                    updateCurrentStatus(messages[currentStep]);
                    updateProgressFill((currentStep + 1) * 25);
                    
                    currentStep++;
                } else {
                    clearInterval(interval);
                }
            }, 2000); // Change step every 2 seconds

            return interval;
        }

        function showResult(content) {
            // Store the original markdown content
            originalMarkdownContent = content;
            
            // Configure marked options for better rendering
            marked.setOptions({
                breaks: true,
                gfm: true,
                headerIds: false,
                mangle: false
            });
            
            // Render markdown to HTML
            const htmlContent = marked.parse(content);
            resultContent.innerHTML = htmlContent;
            resultContent.className = 'result-content success';
            resultContainer.style.display = 'block';
            downloadSection.style.display = 'block';
            statusText.textContent = 'Analysis completed successfully!';
        }

        function showError(message) {
            resultContent.innerHTML = '<strong>Error:</strong> ' + message;
            resultContent.className = 'result-content error';
            resultContainer.style.display = 'block';
            statusText.textContent = 'Analysis error';
        }

        function resetUI() {
            analyzeBtn.disabled = false;
            analyzeBtn.textContent = '🚀 Analyze Website';
            loading.style.display = 'none';
            downloadSection.style.display = 'none';
            
            // Reset all progress steps
            const steps = ['scraping', 'classification', 'aggregation', 'summary'];
            steps.forEach(step => {
                updateProgress(step, '');
            });
            
            // Reset progress bar
            updateProgressFill(0);
            updateCurrentStatus('');
        }

        // About section functionality
        const aboutBtn = document.querySelector('.about-btn');
        const aboutSection = document.getElementById('about-section');
        const mainContent = document.getElementById('main-content');

        aboutBtn.addEventListener('click', () => {
            if (aboutSection.classList.contains('active')) {
                // Hide about section
                aboutSection.classList.remove('active');
                aboutBtn.textContent = 'About';
                mainContent.style.display = 'block';
            } else {
                // Show about section
                aboutSection.classList.add('active');
                aboutBtn.textContent = 'Back to Tool';
                mainContent.style.display = 'none';
            }
        });

        // Store the original markdown content
        let originalMarkdownContent = '';

        // Download PDF functionality
        downloadPdfBtn.addEventListener('click', async () => {
            downloadPdfBtn.disabled = true;
            downloadPdfBtn.textContent = '⏳ Generating PDF...';
            
            try {
                // Create a temporary container for PDF generation
                const tempContainer = document.createElement('div');
                tempContainer.style.cssText = `
                    position: absolute;
                    left: -9999px;
                    top: -9999px;
                    width: 800px;
                    background: white;
                    padding: 40px;
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    color: #2d3748;
                    line-height: 1.6;
                    max-height: none;
                    overflow: visible;
                `;
                
                // Clone the result content and remove max-height constraint
                const clonedContent = resultContent.cloneNode(true);
                clonedContent.style.maxHeight = 'none';
                clonedContent.style.overflow = 'visible';
                tempContainer.appendChild(clonedContent);
                document.body.appendChild(tempContainer);
                
                // Wait a bit for the content to render fully
                await new Promise(resolve => setTimeout(resolve, 100));
                
                // Generate PDF with full content
                const canvas = await html2canvas(tempContainer, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: '#ffffff',
                    height: tempContainer.scrollHeight,
                    windowHeight: tempContainer.scrollHeight
                });
                
                // Remove temporary container
                document.body.removeChild(tempContainer);
                
                // Create PDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                const imgData = canvas.toDataURL('image/png');
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = pdf.internal.pageSize.getHeight();
                const imgWidth = pdfWidth;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pdfHeight;
                
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pdfHeight;
                }
                
                // Generate filename
                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                const filename = `market-insight-report-${timestamp}.pdf`;
                
                // Download PDF
                pdf.save(filename);
                
                downloadPdfBtn.textContent = '✅ PDF Downloaded!';
                setTimeout(() => {
                    downloadPdfBtn.textContent = '📄 PDF Report';
                    downloadPdfBtn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                downloadPdfBtn.textContent = '❌ PDF Failed';
                setTimeout(() => {
                    downloadPdfBtn.textContent = '📄 PDF Report';
                    downloadPdfBtn.disabled = false;
                }, 2000);
            }
        });

        // Download Markdown functionality
        downloadMdBtn.addEventListener('click', () => {
            downloadMdBtn.disabled = true;
            downloadMdBtn.textContent = '⏳ Generating MD...';
            
            try {
                // Generate filename
                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                const filename = `market-insight-report-${timestamp}.md`;
                
                // Create blob and download
                const blob = new Blob([originalMarkdownContent], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                downloadMdBtn.textContent = '✅ MD Downloaded!';
                setTimeout(() => {
                    downloadMdBtn.textContent = '📝 Markdown';
                    downloadMdBtn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Error downloading Markdown:', error);
                downloadMdBtn.textContent = '❌ MD Failed';
                setTimeout(() => {
                    downloadMdBtn.textContent = '📝 Markdown';
                    downloadMdBtn.disabled = false;
                }, 2000);
            }
        });

        // Download Text functionality
        downloadTxtBtn.addEventListener('click', () => {
            downloadTxtBtn.disabled = true;
            downloadTxtBtn.textContent = '⏳ Generating TXT...';
            
            try {
                // Convert HTML to plain text
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = resultContent.innerHTML;
                const plainText = tempDiv.textContent || tempDiv.innerText || '';
                
                // Generate filename
                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                const filename = `market-insight-report-${timestamp}.txt`;
                
                // Create blob and download
                const blob = new Blob([plainText], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                downloadTxtBtn.textContent = '✅ TXT Downloaded!';
                setTimeout(() => {
                    downloadTxtBtn.textContent = '📄 Text File';
                    downloadTxtBtn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Error downloading Text:', error);
                downloadTxtBtn.textContent = '❌ TXT Failed';
                setTimeout(() => {
                    downloadTxtBtn.textContent = '📄 Text File';
                    downloadTxtBtn.disabled = false;
                }, 2000);
            }
        });

        // Auto-focus on input
        urlInput.focus();

        // Automatically add https:// if not provided
        urlInput.addEventListener('blur', function() {
            let url = this.value.trim();
            if (url && !url.startsWith('http://') && !url.startsWith('https://')) {
                this.value = 'https://' + url;
            }
        });
    </script>
</body>
</html> 